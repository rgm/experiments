#!/usr/bin/env bash

# start-nrepl
# start up an nrepl-enabled clojure process, simulates calva jack-in for neovim
# nvim usage: `:term script/start-nrepl`

set -euo pipefail
cd "$(dirname "$0")/.."

clj -Adev \
    -Sdeps '{:deps {nrepl/nrepl {:mvn/version "1.5.2"}
                    cider/cider-nrepl {:mvn/version "0.58.0"}
                    cider/piggieback {:mvn/version "0.6.1"}}}' \
    -M -m nrepl.cmdline \
    --middleware '[cider.nrepl/cider-middleware shadow.cljs.devtools.server.nrepl/middleware]' \
    --interactive --color
